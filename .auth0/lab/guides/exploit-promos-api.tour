{
  "$schema": "https://aka.ms/codetour-schema",
  "title": "#3 - Exploit the Promos API",
  "nextTour": "#4 - Configure API Access Management",
  "steps": [
    {
      "title": "Lab overview",
      "description": "## Launch and Set up the Promos Apps\n\n🎯 **Objective**:   Explore a vulnerability in the Promos API.\n\n⏱️ **Duration**:    10 minutes\n\n**Scenario**: Okta Ice asked you to confirm a vulnerability in the Promos App.\nAccording to the security team, hackers can circumvent the security to\naccess premium promos.\n\n![](https://raw.githubusercontent.com/OktaEdu/es-delivery-apiam/refs/heads/ondemand/media/image6.png)\n"
    },
    {
      "title": "Launch the Promos API",
      "description": "## Launch the Promos API\n\n1.  Click [here](command:workbench.action.terminal.toggleTerminal) to toggle open the integrated terminal at the bottom of your screen.\n\n2. Click [here](command:codetour.sendTextToTerminal?[\"cd ice-resource-server; npm install; npm serve\"]) to install and launch the Promos API.\n>This runs the command `npm install` and `npm serve` in the `/ice-resource-server` directory.\n\n3.  Select **Make public** in the window that pops up at the bottom right of your environment.\n\n4. Select the **PORTS** tab. \n\n5. Next to the ice-resource-server API, hover over the **Forwarded Address** column and select the globe icon. This will launch your the Promos API in a new browser tab.\n> A JSON response is displayed.\n"
    },
    {
      "title": "Access the Premium Promos Page",
      "description": "## Access the Premium Promos Page\n\n1.  In your browser, visit the Ice SPA.\n\n2.  If you aren’t already logged out, click **Logout**.\n\n3.  Click **Promos** to view the publicly available promos.\n\n4.  Click **Log In** and login as oktatraining.\n\n5.  Click **Promos**. Now that you’re authenticated, you’ll see a\n    **Premium Promos** button.\n\n6.  Click **Premium Promos** to view the premium (non-public) promos.",
      "selection": {
        "start": {
          "line": 1,
          "character": 4
        },
        "end": {
          "line": 1,
          "character": 34
        }
      }
    },
    {
      "title": "Access the /promos/PREMIUM API without Authentication",
      "description": "## Access the /promos/PREMIUM API without Authentication\n1.  While on the **Promos** page in Chrome, open Google Developer toolsby right-clicking the\n    browser window and selecting **Inspect**.\n\n2.  Click **Network** to begin inspecting your network traffic.\n\n3.  Click **Premium Promos**.\n\n4.  The Network pane displays a request for the **PREMIUM** promos\n    endpoint. Click on **PREMIUM** in the Network pane.\n\n5.  If not already selected, click the **Headers** tab to view details\n    about the REST API request to the `/promos/PREMIUM` endpoint.\n\n    ![](https://raw.githubusercontent.com/OktaEdu/es-delivery-apiam/refs/heads/ondemand/media/image7.png)\n\n6.  Copy the PREMIUM REST API URL endpoint ending with `promos/PREMIUM`.\n\n7.  Close the Developer Tools panel.\n\n8.  Click **Logout** in the SPA app to end your Okta session.\n\n9.  In a new Chrome tab, go to the **PREMIUM** promos endpoint you copied in step 6.\n\n10. From the results, confirm that you have access to the premium\n    promos, despite not being authenticated with Okta.\n    >This is evidence that this API endpoint is not protected, and is vulnerable to being publicly accessible.\n\n![](https://raw.githubusercontent.com/OktaEdu/es-delivery-apiam/refs/heads/ondemand/media/image8.png)\n\n"
    },
    {
      "title": "Lab checkpoint",
      "description": "## ✅ Checkpoint\n\nAt this point, you have confirmed that the Promos PREMIUM endpoint\nrequires protection if we want to limit access to premium customers.\n\n  ![](https://raw.githubusercontent.com/OktaEdu/es-delivery-apiam/refs/heads/ondemand/media/image6.png)"
    }
  ],
  "isPrimary": true
}
